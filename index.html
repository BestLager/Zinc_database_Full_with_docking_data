<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Baza ZINC</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- DataTables Bootstrap theme -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">
    
    <style>
        body {
            padding: 20px;
            background-color: #f8f9fa;
        }
        h2 {
            margin-bottom: 20px;
            font-weight: bold;
            color: #333;
        }
        table.dataTable tbody tr:nth-child(odd) {
            background-color: #f2f2f2;
        }
        .img2d {
            max-width: 200px;
            height: auto;
            border-radius: 8px;
            transition: transform 0.3s ease-in-out;
        }
        .img2d:hover {
            transform: scale(2.5);
            z-index: 1000;
            position: relative;
        }
        thead input {
            width: 100%;
            padding: 3px;
            box-sizing: border-box;
            font-size: 0.85em;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>Baza ZINC</h2>
    <table id="tabela" class="table table-striped table-bordered" style="width:100%">
        <thead class="table-dark">
            <tr>
                <th>Zinc ID</th>
                <th>Wzór molekularny</th>
                <th>Binding energy</th>
                <th>Charge</th>
                <th>2D</th>
                <th>Binding energy AD4</th>
                <th>Standard deviation</th>
            </tr>
            <tr>
                <th><input type="text" placeholder="Szukaj ID"></th>
                <th><input type="text" placeholder="Szukaj wzoru"></th>
                <th><input type="text" placeholder="np. > -5"></th>
                <th><input type="text" placeholder="np. = 0"></th>
                <th></th>
                <th><input type="text" placeholder="np. < -3"></th>
                <th><input type="text" placeholder="np. 0,2"></th>
            </tr>
        </thead>
    </table>
</div>

<!-- JS -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

<script>
$(document).ready(function() {
    Papa.parse("Zinc_database_Full_with_docking_data_updated.csv", {
        download: true,
        header: true,
        delimiter: ";",
        skipEmptyLines: true,
        complete: function(results) {
            var table = $('#tabela').DataTable({
                data: results.data,
                pageLength: 25,
                responsive: true,
                orderCellsTop: true,
                fixedHeader: true,
                columns: [
                    { data: 'zincid', defaultContent: '' },
                    { data: 'molecular_formula', defaultContent: '' },
                    { data: 'binding_energy', defaultContent: '' },
                    { data: 'charge', defaultContent: '' },
                    { 
                        data: '2D',
                        defaultContent: '',
                        render: function(data) {
                            return data ? '<img class="img2d" src="' + data + '" alt="2D obraz">' : '';
                        }
                    },
                    { data: 'binding_energy AD4', defaultContent: '' },
                    { data: 'standard deviation', defaultContent: '' }
                ]
            });

            // Filtry w nagłówkach
            $('#tabela thead tr:eq(1) th').each(function (i) {
                $('input', this).on('keyup change', function () {
                    var val = this.value.trim();

                    // Jeśli wpisano warunek liczbowy
                    if (val.match(/^([<>]=?|=)\s*-?\d+[.,]?\d*$/)) {
                        var operator = val.match(/^([<>]=?|=)/)[0];
                        var number = parseFloat(val.replace(/^([<>]=?|=)\s*/, '').replace(',', '.'));

                        $.fn.dataTable.ext.search.push(function(settings, data, dataIndex) {
                            var cellValue = parseFloat((data[i] || "").replace(',', '.'));
                            if (isNaN(cellValue)) return false;
                            if (operator === '>') return cellValue > number;
                            if (operator === '>=') return cellValue >= number;
                            if (operator === '<') return cellValue < number;
                            if (operator === '<=') return cellValue <= number;
                            if (operator === '=') return cellValue === number;
                            return true;
                        });
                        table.draw();
                        $.fn.dataTable.ext.search.pop();
                    } 
                    // Normalne wyszukiwanie tekstowe
                    else {
                        if (table.column(i).search() !== val) {
                            table.column(i).search(val).draw();
                        }
                    }
                });
            });
        }
    });
});
</script>

</body>
</html>
</body>
</html>


